#include <stdio.h>
#include <stdlib.h>
#include <math.h>

const  long double max = 999999999999999999;
 long long int z , a, b, x, n, c, d, h,m;
 long long int j = 0;
 long long int p = 0;
 long long int contador = 0;
int main(){
    scanf("%lld",&z);

    while(j != z){ 
        scanf("%lld %lld %lld %lld %lld %lld %lld",&a,&b,&x,&n,&c,&d,&m);
                while(s <= n){
                    h =((a*(x+s)+b)%m);
                    if(h>=c && h<=d){
                        contador += contador;
                    } 
                    p += p;
        }
        printf("%lld\n",contador);
        contador = 0;
        p = 0;
        j += j;
                }
        j=0;
return 0;
}
